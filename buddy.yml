- pipeline: "Deploy"
  trigger_mode: "ON_EVERY_PUSH"
  ref_name: "master"
  ref_type: "BRANCH"
  trigger_condition: "ALWAYS"
  actions:
  - action: "Build Docker image"
    type: "DOCKERFILE"
    dockerfile_path: "Dockerfile"
    trigger_condition: "ALWAYS"
  - action: "Push Docker image"
    type: "DOCKER_PUSH"
    login: "$DOCKER_HUB_USER"
    password: "secure!RThZ/JIU5MkpT8Czxf9w6cU+kYtiZn708EUoxOpPWHA="
    docker_image_tag: "latest"
    repository: "skillbillsrl/firstjsproject"
    trigger_condition: "ALWAYS"
  - action: "[188.166.25.183] Execute: docker run -id -p 188.166.25.183:80:80 --name test_container --rm skillbillsrl/firstjsproject"
    type: "SSH_COMMAND"
    login: "root"
    password: "secure!UR2u5yEAJ0bCK0sf5SJCjv3bsWy2WWWYs5vol99fdYg="
    host: "188.166.25.183"
    port: "22"
    authentication_mode: "PASS"
    commands:
    - "docker ps -q --filter \"name=test_container\" | grep -q ."
    - "docker rm -f test_container"
    - "docker pull skillbillsrl/firstjsproject"
    - "docker run -id -p 188.166.25.183:8080:80 --name test_container skillbillsrl/firstjsproject"
    run_as_script: true
    shell: "BASH"
    trigger_condition: "ALWAYS"
